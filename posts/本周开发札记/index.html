<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <title>本周开发札记 | Blog for Marguerite Su</title>

  <meta charset="UTF-8">
  <meta name="language" content="en">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  
  

  <link rel="shortcut icon" type="image/png" href="/favicon.ico" />


  
  
    
 
  
  
  
  
  
  
    
    <link type="text/css" rel="stylesheet" href="/css/post.min.b60e0932fe1c50c3d7c5b4f83ee9e4592363654d0f2abf05bbd0678d5b8a214c.css" integrity="sha256-tg4JMv4cUMPXxbT4PunkWSNjZU0PKr8Fu9BnjVuKIUw="/>
  
    
    <link type="text/css" rel="stylesheet" href="/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css" integrity="sha256-47DEQpj8HBSa&#43;/TImW&#43;5JCeuQeRkm5NMpJWZG3hSuFU="/>
  
  
   
   
    

<script type="application/ld+json">
  
    { 
      "@context": "http://schema.org", 
      "@type": "WebSite", 
      "url": "https:\/\/marguerite.github.io\/posts\/%E6%9C%AC%E5%91%A8%E5%BC%80%E5%8F%91%E6%9C%AD%E8%AE%B0\/",
      "name": "本周开发札记",
      "author": {
        "@type": "Person",
        "name": ""
      },
      "description": ""
    }
  
  </script>
</head>

<body>
  <div class="burger__container">
  <div class="burger" aria-controls="navigation" aria-label="Menu">
    <div class="burger__meat burger__meat--1"></div>
    <div class="burger__meat burger__meat--2"></div>
    <div class="burger__meat burger__meat--3"></div>
  </div>
</div>
 

  <nav class="nav" id="navigation">
  <ul class="nav__list">
    
    
  </ul>
</nav>


  <main>
    
    

    <div class="flex-wrapper">
      <div class="post__container">
        <div class="post">
          <header class="post__header">
            <h1 id="post__title">本周开发札记</h1>
            <time datetime="2016-01-23 00:00:00 &#43;0800 CST" class="post__date">Jan 23 2016</time> 
          </header>
          <article class="post__content">
              
<p>盘点一下本周自己在 openSUSE 上面做的工作：</p>
<h4 id="解决了-wine-的-desktop-file-长期以来位于未知类别的-bug">解决了 wine 的 desktop file 长期以来位于未知类别的 bug</h4>
<p>openSUSE 的 wine 从 Ubuntu 抄来了一些 desktop files。而这些文件的 Categories 都是错的（Categories=Wine;Emulator;Documentation;）。根据 freedesktop 的 <a href="http://standards.freedesktop.org/desktop-entry-spec/desktop-entry-spec-latest.html" 
  
   target="_blank" rel="noreferrer noopener" 
>desktop entry specification</a>
 规定，Emulator; 只能跟在 Games; 或者 System; 后面使用，所以是错的，而 Wine; 本身不是一个合法的 Desktop Category; Documentation; 又不符合。统一调整到了 System;Emulator; 类别，而一些可以独立使用的比如 notepad 则视同原生 App 调整到了对应的比如 Utility;Texteditor; 类别。</p>
<h4 id="对-devellanguagesnodejs-源进行了-big-cleanup">对 devel:languages:nodejs 源进行了 big cleanup</h4>
<p>主要是为了我马上要开发的 nodejs-packaging 做准备。npm 由独立打包回归到了与 nodejs 一同打包，而我开发的 nodejs-packaging 又准备使用 bundled packaging 的模式，那么独立打包 npm 时的一些依赖包就不再需要了。这些依赖很早就被我用自动化脚本（简单的 shell script 和 ruby）从 openSUSE:Factory 批量删除了，现在 d:l:nodejs 源里还有一些 broken 状态的尸体。用自动化脚本批量 revoke 了一些 factory-auto-submit 导致的被 rejected 的 SR，然后跑脚本 wipebinaries 从服务器删除 RPM，从服务器 remote delete 掉。</p>
<h4 id="对-golang-packaging-做了三次-bugfix-release">对 golang-packaging 做了三次 bugfix release</h4>
<p>它总是会 filter 掉含有 test,example 字样的编译结果 (类似 test.a，没用)，但是针对 importpath 里有这种字样的（比如 github.com/stretchr/testify）要进行跳过，不然它就什么 Provides/Requires 也抓不出来了。之前仅针对 importpath 本身作了判断，实际上 buildroot 里也会有，因为包名是 golang-github-stretchr-testify 这种，加上了对 buildroot 的判断。</p>
<p>还修复了 golang.attr 里面写错 prefix 的问题。</p>
<h4 id="修了-tw-编译失败的-libtunepimp">修了 TW 编译失败的 libtunepimp</h4>
<p>这个值得一提的是失败的原因：</p>
<p>有些 autotools 工程喜欢用 expr 来比较版本号，这实际上是非常错误的。因为在 expr 下面 1.10 是小于 1.4 的。正确的比较方法是使用 bc：</p>
<pre><code>echo &quot;$TAGLIB_VERSION &gt;= 1.4&quot; | /usr/bin/bc -l
</code></pre>
<p>还值得一提的就是在 .m4 文件里，你是用不了 [ 和 ] 的，因为那是保留的，正确的写法是 @&lt;:@ 和 @:&gt;@。</p>
<h4 id="对-leap-推送了-nodejs-更新">对 Leap 推送了 nodejs 更新</h4>
<p>之前推的更新又把 nodejs-npm 重命名回 npm 了。因为独立打包的 npm 在 Tumbleweed 和 devel:languages:nodejs 里已经移除了（之前在 released product 里一直也都没存在过），命名空间又可用了。但是产生了一个小问题，会导致老的 nodejs-npm 卸载不掉，必须手动卸载然后安装 npm。</p>
<h4 id="更新了-texlive-2015">更新了 TexLive 2015</h4>
<p>其实编译已经完全通过了，但我放弃了。</p>
<p>因为我编译完发现会产生一些莫名奇妙的 release numbers，而在 version 标签里面的 svn version numbers 我又不知道怎么来的。</p>
<p>在 opensuse-packaging 列表上面问才发现，openSUE 下面的 texlive 工程是自动编译的，由 Publishing:Texlive Meta 这个软件包里的脚本控制，我们甚至打包了整个 ctan&hellip;那我的硬盘不够跑的，Werner 已经有了，我就没必要干破坏自动化的事情了。</p>
<h4 id="更新了一些软件包">更新了一些软件包</h4>
<p>Cutegram，WeCase，doubanfm-qt5。</p>
<p>把文泉驿微米黑更新到最新的 nightly build 版本（wenq.org 论坛里的那个 NB 其实房教授一直不定期的跑）。</p>
<p>把一些失效的中文项目比如 lwqq，openfetion 进行了禁用编译、保留软件包工程的操作。</p>
<p>在 home:MargueriteSu 里打包了 shadowsocks-go</p>
<p>在 home:opensuse_zh:infinality 打包了最新的打过 infinality 补丁的 cairo, freetype2, fontconfig。</p>
<p>帮助 syncthing 的打包者修复了编译（go 应用）</p>
<p>把 toxcore, qtox 提交到了 server:messaging 源，等通过后让 qtox 进入 Tumbleweed</p>
<h4 id="新打包">新打包</h4>
<p>basket5，basket 笔记的 KF5 移植，功能都保留着，非常好用。</p>
<p>sadlen 的 marknoto/markpado。前者是一个笔记应用，后者是一个非常好的 KDE 5 下面的 Markdown 编辑器，基于 katepart。我本人都在用。</p>
<h4 id="todo">TODO</h4>
<p>本周末主要的任务就是把 Fedora 的 nodejs-packaging 的原理搞明白，用 Ruby port 到 openSUSE，并支持我们的 bundled packaging 模式。</p>
<p>接下来在本地搭建一个 discourse 服务器看下内存占用，毕竟 @phoenixlzx 现在是根本不要前在给我们跑论坛和域名，总不好又恬着大脸要加内存吧（想再搞一次捐款，可确实没什么可以送的）</p>
<p>写文章的话准备写一下我的博客程序 ghost 是怎么搭建的，或者谈一下我对 devel:languages:nodejs 源自动化打包的蓝图设计。</p>
<p>至于论坛活动啊，调试 ocserv/telepathy-kde/privoxy，这些长期的或者尚未取得进展的活动就不值得预告了。</p>


              
          </article>
          

 <div class="pagination">
  
    <a class="pagination__item" href="https://marguerite.github.io/posts/%E8%84%91%E6%B4%9E%E5%A4%A7%E5%BC%80%E7%9A%84%E5%91%A8%E6%9C%AB/">
        <span class="pagination__label">Previous Post</span>
        <span class="pagination__title">脑洞大开的周末</span>
    </a>
  

  
    <a class="pagination__item" href="https://marguerite.github.io/posts/introducing_the_brand_new_nodejs_packaging/">
      <span class="pagination__label">Next Post</span>
      <span class="pagination__title" >Introducing the brand new nodejs packaging</span>
    </a>
  
</div>

          
          <footer class="post__footer">
            


<div class="social-icons">
  
     
    
  
     
    
  
     
    
  
     
    
  
     
    
  
     
    
  
     
    
  
     
    
     
</div>

            <p></p>
          </footer>
          </div>
      </div>
      
    </div>
    

  </main>

   

  
  <script src="/js/index.min.49e4d8a384357d9b445b87371863419937ede9fa77737522ffb633073aebfa44.js" integrity="sha256-SeTYo4Q1fZtEW4c3GGNBmTft6fp3c3Ui/7YzBzrr&#43;kQ=" crossorigin="anonymous"></script>
  
  
  <script src="https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js"></script>

  
  <script src="https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js"
    data-autoloader-path="https://unpkg.com/prismjs@1.20.0/components/"></script>

  


</body>

</html>
